{"version":3,"sources":["../../src/service/emaillogs.js"],"names":["EmailLogs","log","data","Promise","resolve","reject","logs","status","emailLogs","email","email_response","envelope","to","from","time","Date","user","subject","body","tag_id","save","err","result","console","email_log"],"mappings":";;;;;;;;;AAAA;;;;AACA;;;;;;;;IAEaA,S,WAAAA,S;;;;;;;iCACAC,G,EAAKC,I,EAAM;AAChB,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,oBAAIC,OAAO,EAAX;AACA,oBAAIJ,QAAQA,KAAKK,MAAjB,EAAyB;AACrB,wBAAIN,IAAIO,SAAR,EAAmB;AACfF,+BAAO,IAAIL,IAAIO,SAAR,CAAkB,EAAEC,OAAOP,KAAKQ,cAAL,CAAoBC,QAApB,CAA6BC,EAAtC,EAA0CC,MAAMX,KAAKQ,cAAL,CAAoBC,QAApB,CAA6BE,IAA7E,EAAmFC,MAAM,IAAIC,IAAJ,EAAzF,EAAqGC,MAAMf,IAAIe,IAAJ,CAASP,KAApH,EAA2HQ,SAASf,KAAKe,OAAzI,EAAkJC,MAAMhB,KAAKgB,IAA7J,EAAlB,CAAP;AACH,qBAFD,MAEO;AACHZ,+BAAO,IAAIL,GAAJ,CAAQ,EAAEQ,OAAOP,KAAKQ,cAAL,CAAoBC,QAApB,CAA6BC,EAAtC,EAA0CC,MAAMX,KAAKQ,cAAL,CAAoBC,QAApB,CAA6BE,IAA7E,EAAmFC,MAAM,IAAIC,IAAJ,EAAzF,EAAqGC,MAAM,SAA3G,EAAsHC,SAASf,KAAKe,OAApI,EAA6IC,MAAMhB,KAAKgB,IAAxJ,EAA8JC,QAAQjB,KAAKiB,MAA3K,EAAR,CAAP;AACH;AACDb,yBAAKc,IAAL,CAAU,UAASC,GAAT,EAAcC,MAAd,EAAsB;AAC5B,4BAAI,CAACD,GAAL,EACIjB,QAAQ,SAAR,EADJ,KAGImB,QAAQtB,GAAR,CAAYoB,GAAZ;AACP,qBALD;AAMH,iBAZD,MAYO;AACHjB,4BAAQ,SAAR;AACH;AACJ,aAjBM,CAAP;AAkBH;;;;;;AAEL,IAAMoB,YAAY,IAAIxB,SAAJ,EAAlB;kBACewB,S","file":"emaillogs.js","sourcesContent":["import Imap from \"imap\";\nimport moment from \"moment\";\n\nexport class EmailLogs {\n    emailLog(log, data) {\n        return new Promise((resolve, reject) => {\n            let logs = {};\n            if (data && data.status) {\n                if (log.emailLogs) {\n                    logs = new log.emailLogs({ email: data.email_response.envelope.to, from: data.email_response.envelope.from, time: new Date(), user: log.user.email, subject: data.subject, body: data.body })\n                } else {\n                    logs = new log({ email: data.email_response.envelope.to, from: data.email_response.envelope.from, time: new Date(), user: \"By Cron\", subject: data.subject, body: data.body, tag_id: data.tag_id })\n                }\n                logs.save(function(err, result) {\n                    if (!err)\n                        resolve(\"SUCCESS\");\n                    else\n                        console.log(err)\n                })\n            } else {\n                resolve(\"SUCCESS\");\n            }\n        });\n    }\n}\nconst email_log = new EmailLogs();\nexport default email_log;"]}